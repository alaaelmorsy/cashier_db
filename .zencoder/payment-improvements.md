# ุชุญุณููุงุช ุดุงุดุฉ ุฏูุน ุงููุงุชูุฑุฉ (ุขุฌู)

## ุงูุชุญุณููุงุช ุงููุทุจูุฉ

### 1. ููุน ุฅุฏุฎุงู ูุจูุบ ุฃูู ูู ุฅุฌูุงูู ุงููุงุชูุฑุฉ โ

**ุงููููุน:** `src/renderer/payments/renderer.js`

**ุงูุชุบููุฑุงุช:**
- ุชู ุฅุถุงูุฉ ูุญุต ูู ุฏุงูุฉ `doSettle()` ููุชุญูู ูู ุฃู ุงููุจูุบ ุงููุฏููุน ูุง ููู ุนู ุฅุฌูุงูู ุงููุงุชูุฑุฉ
- ุฅุฐุง ูุงู ุงููุจูุบ ุฃูู ูู ุงูุฅุฌูุงููุ ูุชู ููุน ุงูุนูููุฉ ูุฅุธูุงุฑ ุฑุณุงูุฉ ุชุญุฐูุฑ
- ุงูุฑุณุงูุฉ ุชุนุฑุถ ุงููุจูุบ ุงููุทููุจ ุจูุถูุญ

**ุงูููุฏ:**
```javascript
// Check if cash is less than grand_total
const grandTotal = Number(__currentSale.grand_total||0);
if(cash < grandTotal){
  window.__showPaymentToast && window.__showPaymentToast(`โ๏ธ ูุง ูููู ุฅุฏุฎุงู ูุจูุบ ุฃูู ูู ุฅุฌูุงูู ุงููุงุชูุฑุฉ (${fmt(grandTotal)} ุฑูุงู)`, 'warning');
  // Remove loading state
  dlgOk.classList.remove('btn-loading');
  dlgOk.disabled = false;
  dlgCancel.disabled = false;
  return;
}
```

### 2. ุฑุณุงูุฉ ุชุญุฐูุฑ ุฌูููุฉ โ

**ุงููููุน:** `src/renderer/payments/index.html`

**ุงูุชุบููุฑุงุช:**
- ุฑุณุงูุฉ ุชูุณุช (Toast) ุชุธูุฑ ุจุชุตููู ุฌููู ุจุงูููู ุงูุฃุตูุฑ (ุชุญุฐูุฑ)
- ุชุญุชูู ุนูู ุฃููููุฉ ุชุญุฐูุฑ โ๏ธ ูุชูุถุญ ุงููุจูุบ ุงููุทููุจ
- ุชุธูุฑ ููุฏุฉ 3 ุซูุงูู ุซู ุชุฎุชูู ุชููุงุฆูุงู

**ูุฏุฉ ุงูุนุฑุถ:** ุชู ุชุบููุฑูุง ูู 1.5 ุซุงููุฉ ุฅูู **3 ุซูุงูู**

### 3. ุนุฑุถ ุฅุฌูุงูู ุงููุงุชูุฑุฉ ูู ูุงูุฐุฉ ุงูุณุฏุงุฏ โ

**ุงููููุน:** `src/renderer/payments/index.html` ู `renderer.js`

**ุงูุชุบููุฑุงุช:**
- ุชู ุฅุถุงูุฉ ุญูู ุฌุฏูุฏ ูุนุฑุถ ุฅุฌูุงูู ุงููุงุชูุฑุฉ ุจูุถูุญ
- ูุธูุฑ ุจุฎุท ุนุฑูุถ ูุจุงูููู ุงูุฃุฎุถุฑ
- ูุณุงุนุฏ ุงููุณุชุฎุฏู ุนูู ูุนุฑูุฉ ุงููุจูุบ ุงููุทููุจ ูุจู ุงูุฅุฏุฎุงู

**ุงูุนุฑุถ ูู ุงููุงูุฐุฉ:**
```
๐งพ ุฑูู ุงููุงุชูุฑุฉ: #123
๐ฐ ุฅุฌูุงูู ุงููุงุชูุฑุฉ: 150.00 ุฑูุงู
๐ณ ุทุฑููุฉ ุงูุณุฏุงุฏ: [ุงุฎุชูุงุฑ]
๐ธ ุงููุจูุบ ุงููุณุชูู: [ุฅุฏุฎุงู]
```

### 4. ุนุฑุถ ุงููุจูุบ ุงููุฏููุน ูุงูุจุงูู ูู ุงููุงุชูุฑุฉ ุงููุทุจูุนุฉ โ

**ุงููููุน:** `src/renderer/sales/print.html` ู `print-a4.html`

**ุงูุชุบููุฑุงุช:**
- ุชุญุณูู ููุทู ุญุณุงุจ ุงููุจูุบ ุงููุฏููุน ูุงูุจุงูู
- ุนุฑุถ ูุงุถุญ ูู "ุงููุจูุบ ุงููุฏููุน" ู "ุงูุจุงูู" ุนูุฏ ุฏูุน ูุจูุบ ุฃูุจุฑ ูู ุงูุฅุฌูุงูู

**ุงูุญุงูุงุช:**

#### ุญุงูุฉ 1: ุงููุจูุบ ุงููุฏููุน = ุงูุฅุฌูุงูู
```
ุงูุฅุฌูุงูู ุดุงูู ุงูุถุฑูุจุฉ: 150.00 ุฑูุงู
ุงููุจูุบ ุงููุฏููุน: 150.00 ุฑูุงู
```

#### ุญุงูุฉ 2: ุงููุจูุบ ุงููุฏููุน > ุงูุฅุฌูุงูู
```
ุงูุฅุฌูุงูู ุดุงูู ุงูุถุฑูุจุฉ: 150.00 ุฑูุงู
ุงููุจูุบ ุงููุฏููุน: 200.00 ุฑูุงู
ุงูุจุงูู: 50.00 ุฑูุงู
```

#### ุญุงูุฉ 3: ุงููุจูุบ ุงููุฏููุน < ุงูุฅุฌูุงูู (ุบูุฑ ูููู ุจุนุฏ ุงูุชุญุฏูุซ)
```
ูุฐู ุงูุญุงูุฉ ููููุนุฉ ุงูุขู - ุณูุธูุฑ ุชุญุฐูุฑ ููู ูุชู ุฅุชูุงู ุงูุนูููุฉ
```

## ููููุฉ ุงูุงุณุชุฎุฏุงู

1. **ูุชุญ ุดุงุดุฉ ุฏูุน ุงููุงุชูุฑุฉ (ุขุฌู)**
   - ูู ุงููุงุฆูุฉ ุงูุฑุฆูุณูุฉุ ุงุฎุชุฑ "ุฏูุน ุงูููุงุชูุฑ"

2. **ุงุฎุชูุงุฑ ูุงุชูุฑุฉ ููุณุฏุงุฏ**
   - ุงุจุญุซ ุนู ุงููุงุชูุฑุฉ ุงููุทููุจุฉ
   - ุงุถุบุท ุนูู ุฒุฑ "๐ณ ุณุฏุงุฏ ูุงูู"

3. **ุฅุฏุฎุงู ุจูุงูุงุช ุงูุณุฏุงุฏ**
   - ุณุชุธูุฑ ูุงูุฐุฉ ุชุนุฑุถ ุฑูู ุงููุงุชูุฑุฉ ูุฅุฌูุงูู ุงููุจูุบ ุงููุทููุจ
   - ุงุฎุชุฑ ุทุฑููุฉ ุงูุฏูุน (ูุงุด/ุดุจูุฉ/ุชูุงุฑุง/ุชุงุจู)
   - ุฃุฏุฎู ุงููุจูุบ ุงููุณุชูู (ุฃู ุงุชุฑูู ูุงุฑุบุงู ูููุจูุบ ุงููุงูู)

4. **ุงูุชุญูู ูู ุงููุจูุบ**
   - ุฅุฐุง ุฃุฏุฎูุช ูุจูุบุงู ุฃูู ูู ุงูุฅุฌูุงููุ ุณุชุธูุฑ ุฑุณุงูุฉ ุชุญุฐูุฑ
   - ุงูุฑุณุงูุฉ ุชูุถุญ ุงููุจูุบ ุงููุทููุจ ูุชุฎุชูู ุจุนุฏ 3 ุซูุงูู
   - ูุฌุจ ุฅุฏุฎุงู ูุจูุบ ูุณุงูู ุฃู ุฃูุจุฑ ูู ุงูุฅุฌูุงูู

5. **ุฅุชูุงู ุงูุณุฏุงุฏ**
   - ุงุถุบุท ุนูู "โ ุณุฏุงุฏ ูุทุจุงุนุฉ"
   - ุณุชุชู ุทุจุงุนุฉ ุงููุงุชูุฑุฉ ุชููุงุฆูุงู
   - ุงููุงุชูุฑุฉ ุณุชุนุฑุถ ุงููุจูุบ ุงููุฏููุน ูุงูุจุงูู (ุฅู ูุฌุฏ)

## ูุซุงู ุนููู

**ุณููุงุฑูู:** ูุงุชูุฑุฉ ุฑูู #1234 ุจุฅุฌูุงูู 150.00 ุฑูุงู

### ุงููุญุงููุฉ 1: ุฅุฏุฎุงู ูุจูุบ ุฃูู (100 ุฑูุงู)
```
โ ุงููุชูุฌุฉ: ุฑูุถ ุงูุนูููุฉ
โ๏ธ ุงูุฑุณุงูุฉ: "ูุง ูููู ุฅุฏุฎุงู ูุจูุบ ุฃูู ูู ุฅุฌูุงูู ุงููุงุชูุฑุฉ (150.00 ุฑูุงู)"
```

### ุงููุญุงููุฉ 2: ุฅุฏุฎุงู ุงููุจูุบ ุงููุงูู (150 ุฑูุงู)
```
โ ุงููุชูุฌุฉ: ุชูุช ุงูุนูููุฉ ุจูุฌุงุญ
๐ ุงููุงุชูุฑุฉ ุชุนุฑุถ:
   - ุงููุจูุบ ุงููุฏููุน: 150.00 ุฑูุงู
```

### ุงููุญุงููุฉ 3: ุฅุฏุฎุงู ูุจูุบ ุฃูุจุฑ (200 ุฑูุงู)
```
โ ุงููุชูุฌุฉ: ุชูุช ุงูุนูููุฉ ุจูุฌุงุญ
๐ ุงููุงุชูุฑุฉ ุชุนุฑุถ:
   - ุงููุจูุบ ุงููุฏููุน: 200.00 ุฑูุงู
   - ุงูุจุงูู: 50.00 ุฑูุงู
```

## ุงููููุงุช ุงููุนุฏููุฉ

1. `src/renderer/payments/renderer.js` - ููุทู ุงูุชุญูู ูู ุงููุจูุบ
2. `src/renderer/payments/index.html` - ุนุฑุถ ุฅุฌูุงูู ุงููุงุชูุฑุฉ ููุฏุฉ ุฑุณุงูุฉ ุงูุชุญุฐูุฑ
3. `src/renderer/sales/print.html` - ุนุฑุถ ุงููุจูุบ ุงููุฏููุน ูุงูุจุงูู (ุญุฑุงุฑู)
4. `src/renderer/sales/print-a4.html` - ุนุฑุถ ุงููุจูุบ ุงููุฏููุน ูุงูุจุงูู (A4)

## ููุงุญุธุงุช ูููุฉ

- ุฌููุน ุงูุญุณุงุจุงุช ุชุชู ุจุฏูุฉ ุฑูููู ุนุดุฑููู (.toFixed(2))
- ุงูุฑุณุงุฆู ุชุณุชุฎุฏู ูุธุงู Toast ุงููุฏูุฌ ูู ุงูุดุงุดุฉ
- ุงููุญูุตุงุช ุชุชู ูุจู ุฅุฑุณุงู ุงูุทูุจ ุฅูู ุงูุณูุฑูุฑ
- ุงูููุฏ ูุชุณู ุจูู ุงูุชูุณูู ุงูุญุฑุงุฑู ูA4